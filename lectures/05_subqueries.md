
# 서브쿼리 (Subqueries)

## 1. 서브쿼리 소개

서브쿼리는 다른 SQL 문 내에 포함된 SELECT 문입니다. 이를 통해 복잡한 쿼리를 더 작고 관리하기 쉬운 부분으로 나눌 수 있습니다.

### 서브쿼리의 특징:
- 괄호로 묶여 있음
- 대개 외부 쿼리보다 먼저 실행됨
- 주로 SELECT, FROM, WHERE 절에서 사용됨

## 2. 서브쿼리 유형

### 2.1 단일 행 서브쿼리
하나의 행만 반환하는 서브쿼리입니다.

**예제**:
```sql
SELECT 이름
FROM 학생
WHERE 학년 = (SELECT MAX(학년) FROM 학생);
```

### 2.2 다중 행 서브쿼리
여러 행을 반환하는 서브쿼리입니다. IN, ANY, ALL 등의 연산자와 함께 사용됩니다.

**예제**:
```sql
SELECT 이름
FROM 학생
WHERE 학과 IN (SELECT 학과명 FROM 학과);
```

## 3. 서브쿼리 위치에 따른 분류

### 3.1 WHERE 절 서브쿼리
가장 일반적인 형태의 서브쿼리입니다.

### 3.2 FROM 절 서브쿼리 (인라인 뷰)
FROM 절에 사용되어 임시 테이블처럼 동작합니다.

**예제**:
```sql
SELECT 부서, AVG(연봉) as 평균연봉
FROM (SELECT 부서, 연봉 FROM 직원) AS 부서별연봉
GROUP BY 부서
HAVING 평균연봉 > 50000;
```

### 3.3 SELECT 절 서브쿼리 (스칼라 서브쿼리)
단일 값을 반환하는 서브쿼리로, SELECT 문의 열 목록에 사용됩니다.

**예제**:
```sql
SELECT 이름, 
       (SELECT COUNT(*) FROM 학생 WHERE 학과 = s.학과) AS 같은학과학생수
FROM 학생 s;
```

## 4. 실습

다음 실습을 통해 서브쿼리의 사용법을 익혀보세요:

1. 가장 높은 점수를 받은 학생의 이름을 찾아보세요.
2. '컴퓨터공학' 학과에 속한 학생들의 이름을 조회해보세요.
3. 각 학과별 평균 학년보다 높은 학년의 학생들의 이름과 학과를 조회해보세요.

이 실습 문제들의 해답은 `05_subquery_exercises.sql` 파일에서 확인할 수 있습니다.

